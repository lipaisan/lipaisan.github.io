<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="/localshare/css/share.css">

  
  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/."><i class="fa fa-home"></i> Home</a>
        
          <a class="main-nav-link" href="/archives/"><i class="fa fa-archive"></i> Archive</a>
        
          <a class="main-nav-link" href="/about/"><i class="fa fa-user"></i> About</a>
        
          <a class="main-nav-link" href="/atom.xml"><i class="fa fa-rss"></i> RSS</a>
        
      </nav>
    </div>
    <div id="search-form">
      <div id="result-mask" class="hide"></div>
      <label><input id="search-key" type="text" autocomplete="off" placeholder="search"></label>
      <div id="result-wrap" class="hide">
        <div id="search-result"></div>
      </div>
      <div class="hide">
        <template id="search-tpl">
          <div class="item">
            <a href="/{path}" title="{title}">
              <div class="title">{title}</div>
              <div class="time">{date}</div>
              <div class="tags">{tags}</div>
            </a>
          </div>
        </template>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Python-100-Days-master/Day36-40/39-40.NoSQL数据库入门" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2021-10-17T13:24:55.182Z" itemprop="datePublished">2021年10月17日</time>
</span>
      
      
        <span class="article-views">
  <i class="fa fa-views"></i>
  <i id="busuanzi_container_page_pv">
      <i id="busuanzi_value_page_pv"></i>
  </i>
</span>

      
      
<a href="/2021/10/17/Python-100-Days-master/Day36-40/39-40.NoSQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%85%A5%E9%97%A8/#comments" class="article-comment-link">
  
    
    
    
    
    
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="NoSQL入门"><a href="#NoSQL入门" class="headerlink" title="NoSQL入门"></a>NoSQL入门</h2><h3 id="NoSQL概述"><a href="#NoSQL概述" class="headerlink" title="NoSQL概述"></a>NoSQL概述</h3><p>如今，大多数的计算机系统（包括服务器、PC、移动设备等）都会产生庞大的数据量。其实，早在2012年的时候，全世界每天产生的数据量就达到了2.5EB（艾字节，$$1EB\approx10^{18}B$$）。这些数据有很大一部分是由关系型数据库来存储和管理的。 早在1970年，E.F.Codd发表了论述关系型数据库的著名论文“<em>A relational model of data for large shared data banks</em>”，这篇文章奠定了关系型数据库的基础并在接下来的数十年时间内产生了深远的影响。实践证明，关系型数据库是实现数据持久化最为重要的方式，它也是大多数应用在选择持久化方案时的首选技术。</p>
<p>NoSQL是一项全新的数据库革命性运动，虽然它的历史可以追溯到1998年，但是NoSQL真正深入人心并得到广泛的应用是在进入大数据时候以后，业界普遍认为NoSQL是更适合大数据存储的技术方案，这才使得NoSQL的发展达到了前所未有的高度。2012年《纽约时报》的一篇专栏中写到，大数据时代已经降临，在商业、经济及其他领域中，决策将不再基于经验和直觉而是基于数据和分析而作出。事实上，在天文学、气象学、基因组学、生物学、社会学、互联网搜索引擎、金融、医疗、社交网络、电子商务等诸多领域，由于数据过于密集和庞大，在数据的分析和处理上也遇到了前所未有的限制和阻碍，这一切都使得对大数据处理技术的研究被提升到了新的高度，也使得各种NoSQL的技术方案进入到了公众的视野。</p>
<p>NoSQL数据库按照其存储类型可以大致分为以下几类：</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>部分代表</th>
<th>特点</th>
</tr>
</thead>
<tbody><tr>
<td>列族数据库</td>
<td>HBase<br>Cassandra<br>Hypertable</td>
<td>顾名思义是按列存储数据的。最大的特点是方便存储结构化和半结构化数据，方便做数据压缩，对针对某一列或者某几列的查询有非常大的I/O优势，适合于批量数据处理和即时查询。</td>
</tr>
<tr>
<td>文档数据库</td>
<td>MongoDB<br>CouchDB<br>ElasticSearch</td>
<td>文档数据库一般用类JSON格式存储数据，存储的内容是文档型的。这样也就有机会对某些字段建立索引，实现关系数据库的某些功能，但不提供对参照完整性和分布事务的支持。</td>
</tr>
<tr>
<td>KV数据库</td>
<td>DynamoDB<br>Redis<br>LevelDB</td>
<td>可以通过key快速查询到其value，有基于内存和基于磁盘两种实现方案。</td>
</tr>
<tr>
<td>图数据库</td>
<td>Neo4J<br>FlockDB<br>JanusGraph</td>
<td>使用图结构进行语义查询的数据库，它使用节点、边和属性来表示和存储数据。图数据库从设计上，就可以简单快速的检索难以在关系系统中建模的复杂层次结构。</td>
</tr>
<tr>
<td>对象数据库</td>
<td>db4o<br>Versant</td>
<td>通过类似面向对象语言的语法操作数据库，通过对象的方式存取数据。</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>说明</strong>：想了解更多的NoSQL数据库，可以访问<a target="_blank" rel="noopener" href="http://nosql-database.org/">http://nosql-database.org/</a>。</p>
</blockquote>
<h3 id="Redis概述"><a href="#Redis概述" class="headerlink" title="Redis概述"></a>Redis概述</h3><p>Redis是一种基于键值对的NoSQL数据库，它提供了对多种数据类型（字符串、哈希、列表、集合、有序集合、位图等）的支持，能够满足很多应用场景的需求。Redis将数据放在内存中，因此读写性能是非常惊人的。与此同时，Redis也提供了持久化机制，能够将内存中的数据保存到硬盘上，在发生意外状况时数据也不会丢掉。此外，Redis还支持键过期、地理信息运算、发布订阅、事务、管道、Lua脚本扩展等功能，总而言之，Redis的功能和性能都非常强大，如果项目中要实现高速缓存和消息队列这样的服务，直接交给Redis就可以了。目前，国内外很多著名的企业和商业项目都使用了Redis，包括：Twitter、Github、StackOverflow、新浪微博、百度、优酷土豆、美团、小米、唯品会等。</p>
<h4 id="Redis简介"><a href="#Redis简介" class="headerlink" title="Redis简介"></a>Redis简介</h4><p>2008年，一个名为Salvatore Sanfilippo的程序员为他开发的LLOOGG项目定制了专属的数据库（因为之前他无论怎样优化MySQL，系统性能已经无法再提升了），这项工作的成果就是Redis的初始版本。后来他将Redis的代码放到了全球最大的代码托管平台<a target="_blank" rel="noopener" href="https://github.com/antirez/redis">Github</a>，从那以后，Redis引发了大量开发者的好评和关注，继而有数百人参与了Redis的开发和维护，这使得Redis的功能越来越强大和性能越来越好。</p>
<p>Redis是REmote DIctionary Server的缩写，它是一个用ANSI C编写的高性能的key-value存储系统，与其他的key-value存储系统相比，Redis有以下一些特点（也是优点）：</p>
<ul>
<li>Redis的读写性能极高，并且有丰富的特性（发布/订阅、事务、通知等）。</li>
<li>Redis支持数据的持久化（RDB和AOF两种方式），可以将内存中的数据保存在磁盘中，重启的时候可以再次加载进行使用。</li>
<li>Redis支持多种数据类型，包括：string、hash、list、set，zset、bitmap、hyperloglog等。</li>
<li>Redis支持主从复制（实现读写分析）以及哨兵模式（监控master是否宕机并自动调整配置）。</li>
<li>Redis支持分布式集群，可以很容易的通过水平扩展来提升系统的整体性能。</li>
<li>Redis基于TCP提供的可靠传输服务进行通信，很多编程语言都提供了Redis客户端支持。</li>
</ul>
<h4 id="Redis的应用场景"><a href="#Redis的应用场景" class="headerlink" title="Redis的应用场景"></a>Redis的应用场景</h4><ol>
<li>高速缓存  - 将不常变化但又经常被访问的热点数据放到Redis数据库中，可以大大降低关系型数据库的压力，从而提升系统的响应性能。</li>
<li>排行榜 - 很多网站都有排行榜功能，利用Redis中的列表和有序集合可以非常方便的构造各种排行榜系统。</li>
<li>商品秒杀/投票点赞 - Redis提供了对计数操作的支持，网站上常见的秒杀、点赞等功能都可以利用Redis的计数器通过+1或-1的操作来实现，从而避免了使用关系型数据的<code>update</code>操作。</li>
<li>分布式锁 - 利用Redis可以跨多台服务器实现分布式锁（类似于线程锁，但是能够被多台机器上的多个线程或进程共享）的功能，用于实现一个阻塞式操作。</li>
<li>消息队列 - 消息队列和高速缓存一样，是一个大型网站不可缺少的基础服务，可以实现业务解耦和非实时业务削峰等特性，这些我们都会在后面的项目中为大家展示。</li>
</ol>
<h4 id="Redis的安装和配置"><a href="#Redis的安装和配置" class="headerlink" title="Redis的安装和配置"></a>Redis的安装和配置</h4><p>可以使用Linux系统的包管理工具（如yum）来安装Redis，也可以通过在Redis的<a target="_blank" rel="noopener" href="https://redis.io/">官方网站</a>下载Redis的源代码，解压缩解归档之后通过make工具对源代码进行构建并安装，在更新这篇文档时，Redis官方提供的最新稳定版本是<a target="_blank" rel="noopener" href="https://download.redis.io/releases/redis-5.0.10.tar.gz">Redis 5.0.10</a>。</p>
<p>下载：</p>
<pre><code class="Bash">wget https://download.redis.io/releases/redis-5.0.10.tar.gz
</code></pre>
<p>解压缩和解归档：</p>
<pre><code class="Bash">tar -zxf redis-5.0.10.tar.gz
</code></pre>
<p>进入Redis源代码目录：</p>
<pre><code class="Bash">cd redis-5.0.10
</code></pre>
<p>构建和安装：</p>
<pre><code class="Bash">make &amp;&amp; make install
</code></pre>
<p>在redis源代码目录下有一个名为redis.conf的配置文件，我们可以先查看一下该文件。</p>
<pre><code class="Bash">vim redis.conf
</code></pre>
<p>下面我们对Redis的配置文件进行一个扼要的介绍。</p>
<p>配置Redis服务的IP地址和端口：</p>
<p><img src="./res/redis-bind-and-port.png"></p>
<p>配置底层有多少个数据库：</p>
<p><img src="./res/redis-databases.png"></p>
<p>配置Redis的持久化机制 - RDB。</p>
<p><img src="./res/redis-rdb-1.png"></p>
<p><img src="./res/redis-rdb-3.png"></p>
<p>配置Redis的持久化机制 - AOF：</p>
<p><img src="./res/redis-aof.png"></p>
<p>配置访问Redis服务器的口令：</p>
<p><img src="./res/redis-security.png"></p>
<p>配置Redis的主从复制（通过主从复制可以实现读写分离）：</p>
<p><img src="./res/redis-replication.png"></p>
<p>配置慢查询：</p>
<p><img src="./res/redis-slow-logs.png"></p>
<p>上面这些内容就是Redis的基本配置，如果你对上面的内容感到困惑也没有关系，先把Redis用起来再回头去推敲这些内容就行了。如果想找一些参考书，<a target="_blank" rel="noopener" href="https://item.jd.com/12121730.html">《Redis开发与运维》</a>是一本不错的入门读物，而<a target="_blank" rel="noopener" href="https://item.jd.com/11791607.html">《Redis实战》</a>是不错的进阶读物。</p>
<h4 id="Redis的服务器和客户端"><a href="#Redis的服务器和客户端" class="headerlink" title="Redis的服务器和客户端"></a>Redis的服务器和客户端</h4><p>接下来启动Redis服务器，下面的方式将以默认的配置启动Redis服务。</p>
<pre><code class="Bash">redis-server
</code></pre>
<p>如果希望修改Redis的配置（如端口、认证口令、持久化方式等），可以通过下面两种方式。</p>
<p><strong>方式一</strong>：通过参数指定认证口令和AOF持久化方式。</p>
<pre><code class="Bash">redis-server --requirepass yourpass --appendonly yes
</code></pre>
<p><strong>方式二</strong>：通过指定的配置文件来修改Redis的配置。</p>
<pre><code class="Bash">redis-server /root/redis-5.0.10/redis.conf
</code></pre>
<p>下面我们使用第一种方式来启动Redis并将其置于后台运行，将Redis产生的输出重定向到名为redis.log的文件中。</p>
<pre><code class="Bash">redis-server --requirepass yourpass &gt; redis.log &amp;
</code></pre>
<p>可以通过<code>ps</code>或者<code>netstat</code>来检查Redis服务器是否启动成功。</p>
<pre><code class="Bash">ps -ef | grep redis-server
netstat -nap | grep redis-server
</code></pre>
<p>接下来，我们尝试用Redis命令行工具<code>redis-cli</code>去连接服务器，该工具默认连接本机的<code>6379</code>端口，如果需要指定Redis服务器和端口，可以使用<code>-h</code>和<code>-p</code>参数分别进行指定。</p>
<pre><code class="Bash">redis-cli
</code></pre>
<p>进入命令行工具后，就可以通过Redis的命令来操作Redis服务器，如下所示。</p>
<pre><code class="Bash">127.0.0.1:6379&gt; auth yourpass
OK
127.0.0.1:6379&gt; ping
PONG
127.0.0.1:6379&gt;
</code></pre>
<p>Redis有着非常丰富的数据类型，也有很多的命令来操作这些数据，具体的内容可以查看<a target="_blank" rel="noopener" href="http://redisdoc.com/">Redis命令参考</a>，在这个网站上，除了Redis的命令参考，还有Redis的详细文档，其中包括了通知、事务、主从复制、持久化、哨兵、集群等内容。</p>
<p><img src="./res/redis-data-types.png"></p>
<blockquote>
<p><strong>说明</strong>：上面的插图来自付磊和张益军编著的《Redis开发与运维》一书。</p>
</blockquote>
<pre><code class="Bash">127.0.0.1:6379&gt; set username admin
OK
127.0.0.1:6379&gt; get username
&quot;admin&quot;
127.0.0.1:6379&gt; set password &quot;123456&quot; ex 300
OK
127.0.0.1:6379&gt; get password
&quot;123456&quot;
127.0.0.1:6379&gt; ttl username
(integer) -1
127.0.0.1:6379&gt; ttl password
(integer) 286
127.0.0.1:6379&gt; hset stu1 name hao
(integer) 0
127.0.0.1:6379&gt; hset stu1 age 38
(integer) 1
127.0.0.1:6379&gt; hset stu1 gender male
(integer) 1
127.0.0.1:6379&gt; hgetall stu1
1) &quot;name&quot;
2) &quot;hao&quot;
3) &quot;age&quot;
4) &quot;38&quot;
5) &quot;gender&quot;
6) &quot;male&quot;
127.0.0.1:6379&gt; hvals stu1
1) &quot;hao&quot;
2) &quot;38&quot;
3) &quot;male&quot;
127.0.0.1:6379&gt; hmset stu2 name wang age 18 gender female tel 13566778899
OK
127.0.0.1:6379&gt; hgetall stu2
1) &quot;name&quot;
2) &quot;wang&quot;
3) &quot;age&quot;
4) &quot;18&quot;
5) &quot;gender&quot;
6) &quot;female&quot;
7) &quot;tel&quot;
8) &quot;13566778899&quot;
127.0.0.1:6379&gt; lpush nums 1 2 3 4 5
(integer) 5
127.0.0.1:6379&gt; lrange nums 0 -1
1) &quot;5&quot;
2) &quot;4&quot;
3) &quot;3&quot;
4) &quot;2&quot;
5) &quot;1&quot;
127.0.0.1:6379&gt; lpop nums
&quot;5&quot;
127.0.0.1:6379&gt; lpop nums
&quot;4&quot;
127.0.0.1:6379&gt; rpop nums
&quot;1&quot;
127.0.0.1:6379&gt; rpop nums
&quot;2&quot;
127.0.0.1:6379&gt; sadd fruits apple banana orange apple grape grape
(integer) 4
127.0.0.1:6379&gt; scard fruits
(integer) 4
127.0.0.1:6379&gt; smembers fruits
1) &quot;grape&quot;
2) &quot;orange&quot;
3) &quot;banana&quot;
4) &quot;apple&quot;
127.0.0.1:6379&gt; sismember fruits apple
(integer) 1
127.0.0.1:6379&gt; sismember fruits durian
(integer) 0
127.0.0.1:6379&gt; sadd nums1 1 2 3 4 5
(integer) 5
127.0.0.1:6379&gt; sadd nums2 2 4 6 8
(integer) 4
127.0.0.1:6379&gt; sinter nums1 nums2
1) &quot;2&quot;
2) &quot;4&quot;
127.0.0.1:6379&gt; sunion nums1 nums2
1) &quot;1&quot;
2) &quot;2&quot;
3) &quot;3&quot;
4) &quot;4&quot;
5) &quot;5&quot;
6) &quot;6&quot;
7) &quot;8&quot;
127.0.0.1:6379&gt; sdiff nums1 nums2
1) &quot;1&quot;
2) &quot;3&quot;
3) &quot;5&quot;
127.0.0.1:6379&gt; zadd topsinger 5234 zhangxy 1978 chenyx 2235 zhoujl 3520 xuezq
(integer) 4
127.0.0.1:6379&gt; zrange topsinger 0 -1 withscores
1) &quot;chenyx&quot;
2) &quot;1978&quot;
3) &quot;zhoujl&quot;
4) &quot;2235&quot;
5) &quot;xuezq&quot;
6) &quot;3520&quot;
7) &quot;zhangxy&quot;
8) &quot;5234&quot;
127.0.0.1:6379&gt; zrevrange topsinger 0 -1
1) &quot;zhangxy&quot;
2) &quot;xuezq&quot;
3) &quot;zhoujl&quot;
4) &quot;chenyx&quot;
127.0.0.1:6379&gt; zrevrank topsinger zhoujl
(integer) 2
127.0.0.1:6379&gt; geoadd pois 116.39738549206541 39.90862689286386 tiananmen
(integer) 1
127.0.0.1:6379&gt; geoadd pois 116.27172936413572 39.99135172904494 yiheyuan
(integer) 1
127.0.0.1:6379&gt; geoadd pois 117.27766503308104 40.65332064313784 gubeishuizhen
(integer) 1
127.0.0.1:6379&gt; geodist pois tiananmen gubeishuizhen km
&quot;111.5333&quot;
127.0.0.1:6379&gt; geodist pois tiananmen yiheyuan km
&quot;14.1230&quot;
127.0.0.1:6379&gt; georadius pois 116.86499108288572 40.40149669363615 50 km withdist
1) 1) &quot;gubeishuizhen&quot;
   2) &quot;44.7408&quot;
</code></pre>
<h4 id="在Python程序中使用Redis"><a href="#在Python程序中使用Redis" class="headerlink" title="在Python程序中使用Redis"></a>在Python程序中使用Redis</h4><p>可以使用pip安装名为<code>redis</code>的三方库，该三方库的核心是一个名为<code>Redis</code>的类，<code>Redis</code>对象代表一个Redis客户端，通过该客户端可以向Redis服务器发送命令并获取执行的结果。上面我们在Redis客户端中使用的命令基本上就是<code>Redis</code>对象可以接收的消息，所以如果了解了Redis的命令就可以在Python中玩转Redis。</p>
<pre><code class="Bash">pip3 install redis
</code></pre>
<p>进入Python交互式环境，使用<code>redis</code>三方库来操作Redis。</p>
<pre><code class="Bash">&gt;&gt;&gt; import redis
&gt;&gt;&gt;
&gt;&gt;&gt; client = redis.Redis(host=&#39;127.0.0.1&#39;, port=6379, password=&#39;yourpass&#39;)
&gt;&gt;&gt;
&gt;&gt;&gt; client.set(&#39;username&#39;, &#39;admin&#39;)
True
&gt;&gt;&gt; client.hset(&#39;student&#39;, &#39;name&#39;, &#39;luohao&#39;)
1
&gt;&gt;&gt; client.hset(&#39;student&#39;, &#39;age&#39;, 40)
1
&gt;&gt;&gt; client.keys(&#39;*&#39;)
[b&#39;username&#39;, b&#39;student&#39;]
&gt;&gt;&gt; client.get(&#39;username&#39;)
b&#39;admin&#39;
&gt;&gt;&gt; client.hgetall(&#39;student&#39;)
&#123;b&#39;name&#39;: b&#39;luohao&#39;, b&#39;age&#39;: b&#39;40&#39;&#125;
</code></pre>
<h3 id="MongoDB概述"><a href="#MongoDB概述" class="headerlink" title="MongoDB概述"></a>MongoDB概述</h3><h4 id="MongoDB简介"><a href="#MongoDB简介" class="headerlink" title="MongoDB简介"></a>MongoDB简介</h4><p>MongoDB是2009年问世的一个面向文档的数据库管理系统，由C++语言编写，旨在为Web应用提供可扩展的高性能数据存储解决方案。虽然在划分类别的时候后，MongoDB被认为是NoSQL的产品，但是它更像一个介于关系数据库和非关系数据库之间的产品，在非关系数据库中它功能最丰富，最像关系数据库。</p>
<p>MongoDB将数据存储为一个文档，一个文档由一系列的“键值对”组成，其文档类似于JSON对象，但是MongoDB对JSON进行了二进制处理（能够更快的定位key和value），因此其文档的存储格式称为BSON。关于JSON和BSON的差别大家可以看看MongoDB官方网站的文章<a target="_blank" rel="noopener" href="https://www.mongodb.com/json-and-bson">《JSON and BSON》</a>。</p>
<p>目前，MongoDB已经提供了对Windows、macOS、Linux、Solaris等多个平台的支持，而且也提供了多种开发语言的驱动程序，Python当然是其中之一。</p>
<h4 id="MongoDB的安装和启动"><a href="#MongoDB的安装和启动" class="headerlink" title="MongoDB的安装和启动"></a>MongoDB的安装和启动</h4><p>可以从MongoDB的<a target="_blank" rel="noopener" href="https://www.mongodb.com/try/download/community">官方下载链接</a>下载MongoDB，官方提供了Windows、macOS和多种Linux版本的安装包。下面以CentOS为例，简单说一下如何安装和启动MongoDB。</p>
<p>下载服务器和命令行的RPM安装包。</p>
<pre><code class="Bash">wget https://repo.mongodb.org/yum/redhat/7/mongodb-org/4.4/x86_64/RPMS/mongodb-org-server-4.4.2-1.el7.x86_64.rpm
rpm -ivh mongodb-org-server-4.4.2-1.el7.x86_64.rpm
wget https://repo.mongodb.org/yum/redhat/7/mongodb-org/4.4/x86_64/RPMS/mongodb-org-shell-4.4.2-1.el7.x86_64.rpm
rpm -ivh mongodb-org-shell-4.4.2-1.el7.x86_64.rpm
</code></pre>
<p>启动MongoDB服务器，需要先创建保存数据的文件夹。</p>
<pre><code class="Bash">mkdir -p /data/db
</code></pre>
<p>修改MongoDB的配置文件，将其中<code>bindIp</code>选项的值修改为本机IP地址而不是默认的<code>127.0.0.1</code>，本机IP地址可以通过<code>ifconfig</code>命令进行查看。</p>
<pre><code class="Bash">vim /etc/mongod.conf
</code></pre>
<p>使用<code>systemctl</code>命令启动服务。</p>
<pre><code class="Bash">systemctl start mongod
</code></pre>
<h4 id="MongoDB基本概念"><a href="#MongoDB基本概念" class="headerlink" title="MongoDB基本概念"></a>MongoDB基本概念</h4><p>我们通过与关系型数据库的比较来说明MongoDB中的一些概念。</p>
<table>
<thead>
<tr>
<th>SQL</th>
<th>MongoDB</th>
</tr>
</thead>
<tbody><tr>
<td>database</td>
<td>database</td>
</tr>
<tr>
<td>table（表）</td>
<td>collection（集合）</td>
</tr>
<tr>
<td>row（行）</td>
<td>document（文档）</td>
</tr>
<tr>
<td>column（列）</td>
<td>field（字段）</td>
</tr>
<tr>
<td>index</td>
<td>index</td>
</tr>
<tr>
<td>table joins（表连接）</td>
<td>（嵌套文档）</td>
</tr>
<tr>
<td>primary key</td>
<td>primary key</td>
</tr>
</tbody></table>
<h4 id="通过Shell操作MongoDB"><a href="#通过Shell操作MongoDB" class="headerlink" title="通过Shell操作MongoDB"></a>通过Shell操作MongoDB</h4><ol start="0">
<li><p>启动命令行工具，进入交互式环境。</p>
<pre><code class="Bash">mongo
</code></pre>
<blockquote>
<p><strong>说明</strong>：</p>
</blockquote>
</li>
<li><p>查看、创建和删除数据库。</p>
<pre><code class="JavaScript">&gt; // 显示所有数据库
&gt; show dbs
admin   0.000GB
config  0.000GB
local   0.000GB
&gt; // 创建并切换到school数据库
&gt; use school
switched to db school
&gt; // 删除当前数据库
&gt; db.dropDatabase()
&#123; &quot;ok&quot; : 1 &#125;
</code></pre>
</li>
<li><p>创建、删除和查看集合。</p>
<pre><code class="JavaScript">&gt; // 创建并切换到school数据库
&gt; use school
switched to db school
&gt; // 创建colleges集合
&gt; db.createCollection(&#39;colleges&#39;)
&#123; &quot;ok&quot; : 1 &#125;
&gt; // 创建students集合
&gt; db.createCollection(&#39;students&#39;)
&#123; &quot;ok&quot; : 1 &#125;
&gt; // 查看所有集合
&gt; show collections
colleges
students
&gt; // 删除colleges集合
&gt; db.colleges.drop()
true
</code></pre>
<blockquote>
<p><strong>说明</strong>：在MongoDB中插入文档时如果集合不存在会自动创建集合，所以也可以按照下面的方式通过插入文档来创建集合。</p>
</blockquote>
</li>
<li><p>文档的CRUD操作。</p>
<pre><code class="JavaScript">&gt; // 向students集合插入文档
&gt; db.students.insert(&#123;stuid: 1001, name: &#39;骆昊&#39;, age: 40&#125;)
WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)
&gt; // 向students集合插入文档
&gt; db.students.save(&#123;stuid: 1002, name: &#39;王大锤&#39;, tel: &#39;13012345678&#39;, gender: &#39;男&#39;&#125;)
WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)
&gt; // 查看所有文档
&gt; db.students.find()
&#123; &quot;_id&quot; : ObjectId(&quot;5b13c72e006ad854460ee70b&quot;), &quot;stuid&quot; : 1001, &quot;name&quot; : &quot;骆昊&quot;, &quot;age&quot; : 38 &#125;
&#123; &quot;_id&quot; : ObjectId(&quot;5b13c790006ad854460ee70c&quot;), &quot;stuid&quot; : 1002, &quot;name&quot; : &quot;王大锤&quot;, &quot;tel&quot; : &quot;13012345678&quot;, &quot;gender&quot; : &quot;男&quot; &#125;
&gt; // 更新stuid为1001的文档
&gt; db.students.update(&#123;stuid: 1001&#125;, &#123;&#39;$set&#39;: &#123;tel: &#39;13566778899&#39;, gender: &#39;男&#39;&#125;&#125;)
WriteResult(&#123; &quot;nMatched&quot; : 1, &quot;nUpserted&quot; : 0, &quot;nModified&quot; : 1 &#125;)
&gt; // 插入或更新stuid为1003的文档
&gt; db.students.update(&#123;stuid: 1003&#125;, &#123;&#39;$set&#39;: &#123;name: &#39;白元芳&#39;, tel: &#39;13022223333&#39;, gender: &#39;男&#39;&#125;&#125;,  upsert=true)
WriteResult(&#123;
        &quot;nMatched&quot; : 0,
        &quot;nUpserted&quot; : 1,
        &quot;nModified&quot; : 0,
        &quot;_id&quot; : ObjectId(&quot;5b13c92dd185894d7283efab&quot;)
&#125;)
&gt; // 查询所有文档
&gt; db.students.find().pretty()
&#123;
        &quot;_id&quot; : ObjectId(&quot;5b13c72e006ad854460ee70b&quot;),
        &quot;stuid&quot; : 1001,
        &quot;name&quot; : &quot;骆昊&quot;,
        &quot;age&quot; : 38,
        &quot;gender&quot; : &quot;男&quot;,
        &quot;tel&quot; : &quot;13566778899&quot;
&#125;
&#123;
        &quot;_id&quot; : ObjectId(&quot;5b13c790006ad854460ee70c&quot;),
        &quot;stuid&quot; : 1002,
        &quot;name&quot; : &quot;王大锤&quot;,
        &quot;tel&quot; : &quot;13012345678&quot;,
        &quot;gender&quot; : &quot;男&quot;
&#125;
&#123;
        &quot;_id&quot; : ObjectId(&quot;5b13c92dd185894d7283efab&quot;),
        &quot;stuid&quot; : 1003,
        &quot;gender&quot; : &quot;男&quot;,
        &quot;name&quot; : &quot;白元芳&quot;,
        &quot;tel&quot; : &quot;13022223333&quot;
&#125;
&gt; // 查询stuid大于1001的文档
&gt; db.students.find(&#123;stuid: &#123;&#39;$gt&#39;: 1001&#125;&#125;).pretty()
&#123;
        &quot;_id&quot; : ObjectId(&quot;5b13c790006ad854460ee70c&quot;),
        &quot;stuid&quot; : 1002,
        &quot;name&quot; : &quot;王大锤&quot;,
        &quot;tel&quot; : &quot;13012345678&quot;,
        &quot;gender&quot; : &quot;男&quot;
&#125;
&#123;
        &quot;_id&quot; : ObjectId(&quot;5b13c92dd185894d7283efab&quot;),
        &quot;stuid&quot; : 1003,
        &quot;gender&quot; : &quot;男&quot;,
        &quot;name&quot; : &quot;白元芳&quot;,
        &quot;tel&quot; : &quot;13022223333&quot;
&#125;
&gt; // 查询stuid大于1001的文档只显示name和tel字段
&gt; db.students.find(&#123;stuid: &#123;&#39;$gt&#39;: 1001&#125;&#125;, &#123;_id: 0, name: 1, tel: 1&#125;).pretty()
&#123; &quot;name&quot; : &quot;王大锤&quot;, &quot;tel&quot; : &quot;13012345678&quot; &#125;
&#123; &quot;name&quot; : &quot;白元芳&quot;, &quot;tel&quot; : &quot;13022223333&quot; &#125;
&gt; // 查询name为“骆昊”或者tel为“13022223333”的文档
&gt; db.students.find(&#123;&#39;$or&#39;: [&#123;name: &#39;骆昊&#39;&#125;, &#123;tel: &#39;13022223333&#39;&#125;]&#125;, &#123;_id: 0, name: 1, tel: 1&#125;).pretty()
&#123; &quot;name&quot; : &quot;骆昊&quot;, &quot;tel&quot; : &quot;13566778899&quot; &#125;
&#123; &quot;name&quot; : &quot;白元芳&quot;, &quot;tel&quot; : &quot;13022223333&quot; &#125;
&gt; // 查询学生文档跳过第1条文档只查1条文档
&gt; db.students.find().skip(1).limit(1).pretty()
&#123;
        &quot;_id&quot; : ObjectId(&quot;5b13c790006ad854460ee70c&quot;),
        &quot;stuid&quot; : 1002,
        &quot;name&quot; : &quot;王大锤&quot;,
        &quot;tel&quot; : &quot;13012345678&quot;,
        &quot;gender&quot; : &quot;男&quot;
&#125;
&gt; // 对查询结果进行排序(1表示升序，-1表示降序)
&gt; db.students.find(&#123;&#125;, &#123;_id: 0, stuid: 1, name: 1&#125;).sort(&#123;stuid: -1&#125;)
&#123; &quot;stuid&quot; : 1003, &quot;name&quot; : &quot;白元芳&quot; &#125;
&#123; &quot;stuid&quot; : 1002, &quot;name&quot; : &quot;王大锤&quot; &#125;
&#123; &quot;stuid&quot; : 1001, &quot;name&quot; : &quot;骆昊&quot; &#125;
&gt; // 在指定的一个或多个字段上创建索引
&gt; db.students.ensureIndex(&#123;name: 1&#125;)
&#123;
        &quot;createdCollectionAutomatically&quot; : false,
        &quot;numIndexesBefore&quot; : 1,
        &quot;numIndexesAfter&quot; : 2,
        &quot;ok&quot; : 1
&#125;
</code></pre>
</li>
</ol>
<p>使用MongoDB可以非常方便的配置数据复制，通过冗余数据来实现数据的高可用以及灾难恢复，也可以通过数据分片来应对数据量迅速增长的需求。关于MongoDB更多的操作可以查阅<a target="_blank" rel="noopener" href="https://mongodb-documentation.readthedocs.io/en/latest/">官方文档</a> ，同时推荐大家阅读Kristina Chodorow写的<a target="_blank" rel="noopener" href="http://www.ituring.com.cn/book/1172">《MongoDB权威指南》</a>。</p>
<h4 id="在Python程序中操作MongoDB"><a href="#在Python程序中操作MongoDB" class="headerlink" title="在Python程序中操作MongoDB"></a>在Python程序中操作MongoDB</h4><p>可以通过pip安装<code>pymongo</code>来实现对MongoDB的操作。</p>
<pre><code class="Shell">pip install pymongo
</code></pre>
<p>进入Python交互式环境，就可以执行以下的操作。</p>
<pre><code class="Python">&gt;&gt;&gt; from pymongo import MongoClient
&gt;&gt;&gt;
&gt;&gt;&gt; client = MongoClient(&#39;mongodb://127.0.0.1:27017&#39;) 
&gt;&gt;&gt; db = client.school
&gt;&gt;&gt; for student in db.students.find():
...     print(&#39;学号:&#39;, student[&#39;stuid&#39;])
...     print(&#39;姓名:&#39;, student[&#39;name&#39;])
...     print(&#39;电话:&#39;, student[&#39;tel&#39;])
... 
学号: 1001.0
姓名: 骆昊
电话: 13566778899
学号: 1002.0
姓名: 王大锤
电话: 13012345678
学号: 1003.0
姓名: 白元芳
电话: 13022223333
&gt;&gt;&gt; db.students.find().count()
3
&gt;&gt;&gt; db.students.remove()
&#123;&#39;n&#39;: 3, &#39;ok&#39;: 1.0&#125;
&gt;&gt;&gt; db.students.find().count()
0
&gt;&gt;&gt; from pymongo import ASCENDING
&gt;&gt;&gt;
&gt;&gt;&gt; coll = db.students
&gt;&gt;&gt; coll.create_index([(&#39;name&#39;, ASCENDING)], unique=True)
&#39;name_1&#39;
&gt;&gt;&gt; coll.insert_one(&#123;&#39;stuid&#39;: int(1001), &#39;name&#39;: &#39;骆昊&#39;, &#39;gender&#39;: True&#125;)
&lt;pymongo.results.InsertOneResult object at 0x1050cc6c8&gt;
&gt;&gt;&gt; coll.insert_many([&#123;&#39;stuid&#39;: int(1002), &#39;name&#39;: &#39;王大锤&#39;, &#39;gender&#39;: False&#125;, &#123;&#39;stuid&#39;: int(1003), &#39;name&#39;: &#39;白元芳&#39;, &#39;gender&#39;: True&#125;])
&lt;pymongo.results.InsertManyResult object at 0x1050cc8c8&gt;
&gt;&gt;&gt; for student in coll.find(&#123;&#39;gender&#39;: True&#125;):
...     print(&#39;学号:&#39;, student[&#39;stuid&#39;])
...     print(&#39;姓名:&#39;, student[&#39;name&#39;])
...     print(&#39;性别:&#39;, &#39;男&#39; if student[&#39;gender&#39;] else &#39;女&#39;)
... 
学号: 1001
姓名: 骆昊
性别: 男
学号: 1003
姓名: 白元芳
性别: 男
</code></pre>
<p>关于<a target="_blank" rel="noopener" href="https://api.mongodb.com/python/current/tutorial.html"><code>pymongo</code></a>更多的知识可以通过它的官方文档进行了解，也可以使用<a target="_blank" rel="noopener" href="https://pypi.org/project/mongoengine/"><code>MongoEngine</code></a>这样的库来简化Python程序对MongoDB的操作，除此之外，还有以异步I/O方式访问MongoDB的三方库<a target="_blank" rel="noopener" href="https://pypi.org/project/motor/"><code>motor</code></a>都是不错的选择。</p>

        
            <div id="toc-article">
                
  <div class="widget-wrap" id="toc-wrap">
    <h3 class="widget-title"><i class="fa fa-toc"></i> Contents</h3>
    <div class="widget">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#NoSQL%E5%85%A5%E9%97%A8"><span class="toc-text">NoSQL入门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#NoSQL%E6%A6%82%E8%BF%B0"><span class="toc-text">NoSQL概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis%E6%A6%82%E8%BF%B0"><span class="toc-text">Redis概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Redis%E7%AE%80%E4%BB%8B"><span class="toc-text">Redis简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redis%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">Redis的应用场景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redis%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE"><span class="toc-text">Redis的安装和配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redis%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%92%8C%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">Redis的服务器和客户端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8Python%E7%A8%8B%E5%BA%8F%E4%B8%AD%E4%BD%BF%E7%94%A8Redis"><span class="toc-text">在Python程序中使用Redis</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB%E6%A6%82%E8%BF%B0"><span class="toc-text">MongoDB概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MongoDB%E7%AE%80%E4%BB%8B"><span class="toc-text">MongoDB简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MongoDB%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E5%90%AF%E5%8A%A8"><span class="toc-text">MongoDB的安装和启动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MongoDB%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">MongoDB基本概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87Shell%E6%93%8D%E4%BD%9CMongoDB"><span class="toc-text">通过Shell操作MongoDB</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8Python%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%93%8D%E4%BD%9CMongoDB"><span class="toc-text">在Python程序中操作MongoDB</span></a></li></ol></li></ol></li></ol>
    </div>
  </div>


            </div>
        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://example.com/2021/10/17/Python-100-Days-master/Day36-40/39-40.NoSQL数据库入门/">http://example.com/2021/10/17/Python-100-Days-master/Day36-40/39-40.NoSQL数据库入门/</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
        
<nav id="article-nav">
  
    <a href="/2021/10/17/Python-100-Days-master/Day41-55/41.Django%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2021/10/17/Python-100-Days-master/Day36-40/36-38.%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93MySQL/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

      
      
        







      
    </footer>
  </div>
</article>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-posts"></i> Recent</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/10/17/Python-100-Days-master/%E7%95%AA%E5%A4%96%E7%AF%87/%E9%82%A3%E4%BA%9B%E5%B9%B4%E6%88%91%E4%BB%AC%E8%B8%A9%E8%BF%87%E7%9A%84%E9%82%A3%E4%BA%9B%E5%9D%91/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/10/17/Python-100-Days-master/%E7%95%AA%E5%A4%96%E7%AF%87/%E8%8B%B1%E8%AF%AD%E9%9D%A2%E8%AF%95/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/10/17/Python-100-Days-master/%E7%95%AA%E5%A4%96%E7%AF%87/%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E5%9B%9E%E7%AD%94/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/10/17/Python-100-Days-master/%E7%95%AA%E5%A4%96%E7%AF%87/%E7%94%A8%E5%87%BD%E6%95%B0%E8%BF%98%E6%98%AF%E7%94%A8%E5%A4%8D%E6%9D%82%E7%9A%84%E8%A1%A8%E8%BE%BE%E5%BC%8F/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/10/17/Python-100-Days-master/%E7%95%AA%E5%A4%96%E7%AF%87/%E7%8E%A9%E8%BD%ACPyCharm/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-tag"></i> Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/PEP8/" style="font-size: 10px;">PEP8</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-classify"></i> Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Python%E5%9F%BA%E7%A1%80/">Python基础</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-archive"></i> Archive</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021年10月</a><span class="archive-list-count">173</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019年08月</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-tag"></i> Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/PEP8/" rel="tag">PEP8</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-link"></i> Blogroll</h3>
    <div class="widget">
      <ul>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example1.com/">site-name1</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example2.com/">site-name2</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example3.com/">site-name3</a>
        </li>
      
      </ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <a id="totop" href="#top"></a>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      <p>
        <a href="/sitemap.xml">Site Map</a>
        <span> | </span><a href="/atom.xml">Subscribe to this site</a>
        <span> | </span><a href="/about/">Contact the blogger</a>
      </p>
      
        <p>
          <i class="fa fa-visitors"></i>
          <i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>
          ，
          <i class="fa fa-views"></i>
          <i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>
        </p>
      
      <p>
        <span>Copyright &copy; 2021 John Doe.</span>
        <span>Theme by <a href="https://github.com/chaooo/hexo-theme-BlueLake/" target="_blank">BlueLake.</a></span>
        
            <span>Count by <a href="http://busuanzi.ibruce.info/" target="_blank">busuanzi.</a></span>
        
        <span>Powered by <a href="https://hexo.io/" target="_blank">Hexo.</a></span>
      </p>
    </div>
  </div>
</footer>

    </div>
    
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/search.json.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>






  
<script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



  
<script src="/localshare/js/social-share.js"></script>

  
<script src="/localshare/js/qrcode.js"></script>




















  </div>
</body>
</html>